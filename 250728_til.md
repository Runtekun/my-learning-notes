# TIL - 2025年07月28日

## 今日のメモ
webアプリ:walking_monsterのランキング機能の要件整理と設計を行った。
1. ランキング機能の要件整理と設計
表示したいランキング種類を確定

モンスターレベル（通算）ランキング（リアルタイム処理）

歩数ランキング（通算 / 週間 / 月間） → バッチ処理で対応

リアルタイム処理とバッチ処理の違いや適切な使い分けを検討に検討を重ねた結果、さらなる検討が必要であるとの結論に至った

2. モンスターレベルランキングの実装方針決定
UserMonsterテーブルの level をリアルタイム集計し、常時ランキング表示

UserRanking テーブルへの保存は不要で、軽量なためリアルタイム向き

3. バッチ用テーブル UserRanking の設計とマイグレーション作成
user_id, score, ranking_category, ranking_period, period_start, period_end, rank などを定義

インデックスの設計理由も理解（クエリ高速化のため）

 4. サービスクラス UserRankingAggregator を作成
歩数ランキングを all_time / weekly / monthly で集計・保存

ソートしてランク付けし、UserRanking テーブルに保存

 5. 集計バッチの実行設計
Rakeタスク or Sidekiqジョブを使って集計を定期実行する設計を理解

バッチ処理にするメリット・デメリットを比較して全バッチ処理で進めることを決定した。



## 気分・状態
今日の気分: 🙂 (3: 普通)
今日のモチベーション: ⛅ (3: 普通)
目標の進捗: 🌱 (3: 普通に進んだ)

---
*Generated by ちいくさ日記*  
*Date: 2025-07-28*  
*Created: 2025-07-28 23:01:38*
